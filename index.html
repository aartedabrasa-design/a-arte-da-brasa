import React, { useState } from "react";

const WHATSAPP = "5511999999999"; // SEU NÃšMERO
const TAXA_ENTREGA = 1.0;

const MENU = {
  burgers: [
    { id: 1, name: "ğŸ¥© Brasa Original (Boi)", price: 29.9 },
    { id: 2, name: "ğŸ· Pig Defumado", price: 26.9 },
    { id: 3, name: "ğŸ” Frango da Brasa", price: 24.9 },
    { id: 4, name: "ğŸ’ª Brasa Leve (Fit)", price: 27.9 },
  ],
  box: [
    {
      id: 5,
      name: "ğŸ“¦ Box Casal (2 pessoas)",
      price: 79.9,
      desc:
        "2 pedaÃ§os Fraldinha ou Alcatra\n2 Sobrecoxas desossadas\n2 LinguiÃ§as artesanais\n2 PÃ£es de alho",
    },
    {
      id: 6,
      name: "ğŸ“¦ Box FamÃ­lia (4 pessoas)",
      price: 149.9,
      desc:
        "4 pedaÃ§os Fraldinha ou Alcatra\n4 Sobrecoxas desossadas\n4 LinguiÃ§as artesanais\n4 PÃ£es de alho",
    },
  ],
  drinks: [
    { id: 7, name: "ğŸ¥¤ Refrigerante Lata", price: 6 },
    { id: 8, name: "ğŸ¥¤ Refrigerante 2L", price: 14 },
    { id: 9, name: "ğŸº Cerveja Long Neck", price: 10 },
    { id: 10, name: "ğŸ’§ Ãgua Mineral", price: 4 },
    { id: 11, name: "ğŸ¥¤ Refrigerante Zero", price: 6 },
  ],
};

export default function App() {
  const [cart, setCart] = useState([]);
  const [customer, setCustomer] = useState({
    name: "",
    address: "",
    payment: "PIX",
    obs: "",
  });

  function addItem(item) {
    const found = cart.find((i) => i.id === item.id);
    if (found) {
      setCart(
        cart.map((i) =>
          i.id === item.id ? { ...i, qty: i.qty + 1 } : i
        )
      );
    } else {
      setCart([...cart, { ...item, qty: 1 }]);
    }
  }

  function subtotal() {
    return cart.reduce((acc, i) => acc + i.price * i.qty, 0);
  }

  function total() {
    return subtotal() + TAXA_ENTREGA;
  }

  function sendOrder() {
    if (!customer.name || !customer.address) {
      alert("Preencha nome e endereÃ§o");
      return;
    }

    let msg = `ğŸ”¥ *PEDIDO - A ARTE DA BRASA*\n\n`;
    msg += `ğŸ‘¤ *Cliente:* ${customer.name}\n`;
    msg += `ğŸ“ *EndereÃ§o:* ${customer.address}\n`;
    msg += `ğŸ’³ *Pagamento:* ${customer.payment}\n\n`;
    msg += `ğŸ” *ITENS:*\n`;

    cart.forEach((i) => {
      msg += `â€¢ ${i.qty}x ${i.name} â€” R$ ${(i.price * i.qty)
        .toFixed(2)
        .replace(".", ",")}\n`;
    });

    msg += `\nğŸ’µ *Subtotal:* R$ ${subtotal()
      .toFixed(2)
      .replace(".", ",")}\n`;
    msg += `ğŸšš *Taxa de entrega:* R$ ${TAXA_ENTREGA.toFixed(2).replace(
      ".",
      ","
    )}\n`;
    msg += `ğŸ’° *TOTAL:* R$ ${total().toFixed(2).replace(".", ",")}\n`;

    if (customer.obs) {
      msg += `\nğŸ“ *Obs:* ${customer.obs}\n`;
    }

    window.open(
      `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`,
      "_blank"
    );
  }

  return (
    <div style={{ padding: 20, maxWidth: 500, margin: "auto" }}>
      <h1>ğŸ”¥ A Arte da Brasa</h1>

      {Object.entries(MENU).map(([cat, items]) => (
        <div key={cat}>
          <h3>{cat.toUpperCase()}</h3>
          {items.map((item) => (
            <div key={item.id} style={{ marginBottom: 10 }}>
              <b>{item.name}</b> â€” R$ {item.price.toFixed(2)}
              {item.desc && <pre>{item.desc}</pre>}
              <button onClick={() => addItem(item)}>Adicionar</button>
            </div>
          ))}
        </div>
      ))}

      <hr />

      <h3>ğŸ›’ Carrinho</h3>
      {cart.map((i) => (
        <div key={i.id}>
          {i.qty}x {i.name}
        </div>
      ))}

      <p>Subtotal: R$ {subtotal().toFixed(2)}</p>
      <p>Taxa entrega: R$ {TAXA_ENTREGA.toFixed(2)}</p>
      <b>Total: R$ {total().toFixed(2)}</b>

      <hr />

      <input
        placeholder="Nome"
        onChange={(e) => setCustomer({ ...customer, name: e.target.value })}
      />
      <input
        placeholder="EndereÃ§o"
        onChange={(e) =>
          setCustomer({ ...customer, address: e.target.value })
        }
      />

      <select
        onChange={(e) =>
          setCustomer({ ...customer, payment: e.target.value })
        }
      >
        <option>PIX</option>
        <option>Dinheiro</option>
        <option>CartÃ£o</option>
      </select>

      <textarea
        placeholder="ObservaÃ§Ãµes"
        onChange={(e) => setCustomer({ ...customer, obs: e.target.value })}
      />

      <button onClick={sendOrder}>ğŸ“² Enviar Pedido</button>
    </div>
  );
}
